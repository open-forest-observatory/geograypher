
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../cameras/">
      
      
        <link rel="next" href="../segmentor/">
      
      
      <link rel="icon" href="../../../assets/logo.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.18">
    
    
      
        <title>Derived Cameras Docstrings - Geograypher Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#geograypher.cameras.derived_cameras.MetashapeCameraSet" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Geograypher Documentation" class="md-header__button md-logo" aria-label="Geograypher Documentation" data-md-component="logo">
      
  <img src="../../../assets/logo-shaded.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Geograypher Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Derived Cameras Docstrings
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/open-forest-observatory/geograypher" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    open-forest-observatory/geograypher
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="https://openforestobservatory.org/" class="md-tabs__link">
        
  
  
    
  
  ‚Üê OFO home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
  
    
  
  Overview

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../getting_started/installation/" class="md-tabs__link">
          
  
  
    
  
  Getting started

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../examples_and_applications/examples/" class="md-tabs__link">
          
  
  
    
  
  Examples and applications

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../../software_design/" class="md-tabs__link">
        
  
  
    
  
  Software design

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../entrypoints/" class="md-tabs__link">
          
  
  
    
  
  API reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Geograypher Documentation" class="md-nav__button md-logo" aria-label="Geograypher Documentation" data-md-component="logo">
      
  <img src="../../../assets/logo-shaded.png" alt="logo">

    </a>
    Geograypher Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/open-forest-observatory/geograypher" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    open-forest-observatory/geograypher
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="https://openforestobservatory.org/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ‚Üê OFO home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Getting started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../getting_started/conceptual_workflow/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conceptual workflow
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Examples and applications
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Examples and applications
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples_and_applications/examples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Examples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../examples_and_applications/applications/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Projects using geograypher
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../software_design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Software design
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" checked>
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            API reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../entrypoints/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Entrypoints
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_2" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../meshes/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Meshes
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_2" id="__nav_6_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_2">
            <span class="md-nav__icon md-icon"></span>
            Meshes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../meshes/derived_meshes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Derived Mesh Docstrings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../meshes/meshes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mesh Docstrings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_3" checked>
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Cameras
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_3" id="__nav_6_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_6_3">
            <span class="md-nav__icon md-icon"></span>
            Cameras
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cameras/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Cameras Docstrings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Derived Cameras Docstrings
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Derived Cameras Docstrings
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.MetashapeCameraSet" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MetashapeCameraSet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="¬†MetashapeCameraSet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.MetashapeCameraSet-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.MetashapeCameraSet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.COLMAPCameraSet" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;COLMAPCameraSet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="¬†COLMAPCameraSet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.COLMAPCameraSet-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.COLMAPCameraSet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../segmentor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Segmentor Docstrings
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_4" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../predictors/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Predictors
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_4" id="__nav_6_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_4">
            <span class="md-nav__icon md-icon"></span>
            Predictors
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../predictors/segmentor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Segmentor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../predictors/derived_segmentors/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Derived Segmentors
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../predictors/ortho_segmentor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Ortho segmentor
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6_5" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../../utils/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6_5" id="__nav_6_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_6_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6_5">
            <span class="md-nav__icon md-icon"></span>
            Utils
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/numeric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Numeric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/indexing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Indexing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/geometric/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Geometric
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/geospatial/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Geospatial
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/files/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Files
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Io
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/parsing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Parsing
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/prediction_metrics/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Prediction metrics
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/image/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/visualization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Visualization
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../utils/example_data/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Example Data
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.MetashapeCameraSet" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;MetashapeCameraSet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="¬†MetashapeCameraSet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.MetashapeCameraSet-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.MetashapeCameraSet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.COLMAPCameraSet" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-class"></code>&nbsp;COLMAPCameraSet
    </span>
  </a>
  
    <nav class="md-nav" aria-label="¬†COLMAPCameraSet">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.COLMAPCameraSet-functions" class="md-nav__link">
    <span class="md-ellipsis">
      Functions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Functions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#geograypher.cameras.derived_cameras.COLMAPCameraSet.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-method"></code>&nbsp;__init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/open-forest-observatory/geograypher/edit/main/docs/API_reference/cameras/derived_cameras.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


  <h1>Derived Cameras Docstrings</h1>

<div class="doc doc-object doc-class">



<h2 id="geograypher.cameras.derived_cameras.MetashapeCameraSet" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>MetashapeCameraSet</code>


<a href="#geograypher.cameras.derived_cameras.MetashapeCameraSet" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            PhotogrammetryCameraSet (geograypher.cameras.PhotogrammetryCameraSet)" href="../cameras/#geograypher.cameras.PhotogrammetryCameraSet">PhotogrammetryCameraSet</a></code></p>









              <details class="quote">
                <summary>Source code in <code>geograypher/cameras/derived_cameras.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-44"> 44</a></span>
<span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-44" name="__codelineno-0-44"></a><span class="k">class</span><span class="w"> </span><span class="nc">MetashapeCameraSet</span><span class="p">(</span><span class="n">PhotogrammetryCameraSet</span><span class="p">):</span>
<a id="__codelineno-0-45" name="__codelineno-0-45"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>        <span class="n">camera_file</span><span class="p">:</span> <span class="n">PATH_TYPE</span><span class="p">,</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>        <span class="n">image_folder</span><span class="p">:</span> <span class="n">PATH_TYPE</span><span class="p">,</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>        <span class="n">original_image_folder</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PATH_TYPE</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>        <span class="n">validate_images</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>        <span class="n">default_sensor_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cx&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;cy&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a>    <span class="p">):</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;Parse the information about the camera intrinsics and extrinsics</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">            camera_file (PATH_TYPE):</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">                Path to metashape .xml export</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">            image_folder (PATH_TYPE):</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">                Path to image folder root</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">            original_image_folder (PATH_TYPE, optional):</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">                Path to where the original images for photogrammetry were, which was not included</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">                in the stored image zip files. This is removed from the absolute path recorded in</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">                the camera file. Defaults to None.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">            validate_images (bool, optional): Should the existance of the images be checked.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">                Any image_filenames found in the camera_file that do not exist on disk will be</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">                dropped, leaving a CameraSet only containing existing images. Defaults to False.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">            default_sensor_params (dict, optional):</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">                Default parameters for the intrinsic parameters if not present. Defaults to zeros</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">                &quot;cx&quot; and &quot;cy&quot;.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">            ValueError: If camera calibration does not contain the f, cx, and cy params</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>        <span class="c1"># Load the xml file</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>        <span class="c1"># Taken from here https://rowelldionicio.com/parsing-xml-with-python-minidom/</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>        <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">camera_file</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>        <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>        <span class="c1"># first level</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>        <span class="n">chunk</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;chunk&quot;</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>        <span class="c1"># second level</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>        <span class="n">sensors</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;sensors&quot;</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>        <span class="c1"># Parse the sensors representation</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>        <span class="n">sensors_dict</span> <span class="o">=</span> <span class="n">parse_sensors</span><span class="p">(</span><span class="n">sensors</span><span class="p">,</span> <span class="n">default_sensor_dict</span><span class="o">=</span><span class="n">default_sensor_params</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>        <span class="c1"># Set up the lists to populate</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>        <span class="n">image_filenames</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>        <span class="n">cam_to_world_transforms</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>        <span class="n">sensor_IDs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>        <span class="n">cameras</span> <span class="o">=</span> <span class="n">chunk</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>        <span class="c1"># Iterate over metashape cameras and fill out required information</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>        <span class="k">for</span> <span class="n">cam_or_group</span> <span class="ow">in</span> <span class="n">cameras</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>            <span class="k">if</span> <span class="n">cam_or_group</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>                <span class="k">for</span> <span class="n">cam</span> <span class="ow">in</span> <span class="n">cam_or_group</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                    <span class="n">update_lists</span><span class="p">(</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                        <span class="n">cam</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                        <span class="n">image_folder</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                        <span class="n">cam_to_world_transforms</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                        <span class="n">image_filenames</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                        <span class="n">sensor_IDs</span><span class="p">,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                        <span class="n">original_image_folder</span><span class="o">=</span><span class="n">original_image_folder</span><span class="p">,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                    <span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>            <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>                <span class="n">update_lists</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                    <span class="n">cam_or_group</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                    <span class="n">image_folder</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                    <span class="n">cam_to_world_transforms</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                    <span class="n">image_filenames</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                    <span class="n">sensor_IDs</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                    <span class="n">original_image_folder</span><span class="o">=</span><span class="n">original_image_folder</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>                <span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>        <span class="c1"># Compute the lat lon using the transforms, because the reference values recorded in the file</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>        <span class="c1"># reflect the EXIF values, not the optimized ones</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>        <span class="c1"># Get the transform from the chunk to the earth-centered, earth-fixed (ECEF) frame</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>        <span class="n">chunk_to_epsg4978</span> <span class="o">=</span> <span class="n">parse_transform_metashape</span><span class="p">(</span><span class="n">camera_file</span><span class="o">=</span><span class="n">camera_file</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>        <span class="k">if</span> <span class="n">chunk_to_epsg4978</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>            <span class="c1"># Compute the location of each camera in ECEF</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>            <span class="n">cam_locs_in_epsg4978</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>            <span class="k">for</span> <span class="n">cam_to_world_transform</span> <span class="ow">in</span> <span class="n">cam_to_world_transforms</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>                <span class="n">cam_loc_in_chunk</span> <span class="o">=</span> <span class="n">cam_to_world_transform</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>                <span class="n">cam_locs_in_epsg4978</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk_to_epsg4978</span> <span class="o">@</span> <span class="n">cam_loc_in_chunk</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>            <span class="n">cam_locs_in_epsg4978</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">cam_locs_in_epsg4978</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>            <span class="c1"># Transform these points into lat-lon-alt</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>            <span class="n">transformer</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>                <span class="n">EARTH_CENTERED_EARTH_FIXED_CRS</span><span class="p">,</span> <span class="n">LAT_LON_CRS</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>            <span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>            <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>                <span class="n">xx</span><span class="o">=</span><span class="n">cam_locs_in_epsg4978</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>                <span class="n">yy</span><span class="o">=</span><span class="n">cam_locs_in_epsg4978</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>                <span class="n">zz</span><span class="o">=</span><span class="n">cam_locs_in_epsg4978</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>            <span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>            <span class="n">lon_lats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">))</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>            <span class="c1"># TODO consider trying to parse from the xml</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>            <span class="n">lon_lats</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>        <span class="c1"># Actually construct the camera objects using the base class</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>            <span class="n">cam_to_world_transforms</span><span class="o">=</span><span class="n">cam_to_world_transforms</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>            <span class="n">intrinsic_params_per_sensor_type</span><span class="o">=</span><span class="n">sensors_dict</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>            <span class="n">image_filenames</span><span class="o">=</span><span class="n">image_filenames</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>            <span class="n">lon_lats</span><span class="o">=</span><span class="n">lon_lats</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>            <span class="n">image_folder</span><span class="o">=</span><span class="n">image_folder</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>            <span class="n">sensor_IDs</span><span class="o">=</span><span class="n">sensor_IDs</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>            <span class="n">validate_images</span><span class="o">=</span><span class="n">validate_images</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>            <span class="n">local_to_epsg_4978_transform</span><span class="o">=</span><span class="n">chunk_to_epsg4978</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">








<h3 id="geograypher.cameras.derived_cameras.MetashapeCameraSet-functions">Functions<a href="#geograypher.cameras.derived_cameras.MetashapeCameraSet-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="geograypher.cameras.derived_cameras.MetashapeCameraSet.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">camera_file</span><span class="p">,</span> <span class="n">image_folder</span><span class="p">,</span> <span class="n">original_image_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate_images</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default_sensor_params</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;cx&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;cy&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">})</span></code>

<a href="#geograypher.cameras.derived_cameras.MetashapeCameraSet.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Parse the information about the camera intrinsics and extrinsics</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>camera_file</code>
            </td>
            <td>
                  <code><span title="geograypher.constants.PATH_TYPE">PATH_TYPE</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to metashape .xml export</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>image_folder</code>
            </td>
            <td>
                  <code><span title="geograypher.constants.PATH_TYPE">PATH_TYPE</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to image folder root</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>original_image_folder</code>
            </td>
            <td>
                  <code><span title="geograypher.constants.PATH_TYPE">PATH_TYPE</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to where the original images for photogrammetry were, which was not included
in the stored image zip files. This is removed from the absolute path recorded in
the camera file. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>validate_images</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Should the existance of the images be checked.
Any image_filenames found in the camera_file that do not exist on disk will be
dropped, leaving a CameraSet only containing existing images. Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>default_sensor_params</code>
            </td>
            <td>
                  <code><span title="dict">dict</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default parameters for the intrinsic parameters if not present. Defaults to zeros
"cx" and "cy".</p>
              </div>
            </td>
            <td>
                  <code>{&#39;cx&#39;: 0.0, &#39;cy&#39;: 0.0}</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If camera calibration does not contain the f, cx, and cy params</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>geograypher/cameras/derived_cameras.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-45"> 45</a></span>
<span class="normal"><a href="#__codelineno-0-46"> 46</a></span>
<span class="normal"><a href="#__codelineno-0-47"> 47</a></span>
<span class="normal"><a href="#__codelineno-0-48"> 48</a></span>
<span class="normal"><a href="#__codelineno-0-49"> 49</a></span>
<span class="normal"><a href="#__codelineno-0-50"> 50</a></span>
<span class="normal"><a href="#__codelineno-0-51"> 51</a></span>
<span class="normal"><a href="#__codelineno-0-52"> 52</a></span>
<span class="normal"><a href="#__codelineno-0-53"> 53</a></span>
<span class="normal"><a href="#__codelineno-0-54"> 54</a></span>
<span class="normal"><a href="#__codelineno-0-55"> 55</a></span>
<span class="normal"><a href="#__codelineno-0-56"> 56</a></span>
<span class="normal"><a href="#__codelineno-0-57"> 57</a></span>
<span class="normal"><a href="#__codelineno-0-58"> 58</a></span>
<span class="normal"><a href="#__codelineno-0-59"> 59</a></span>
<span class="normal"><a href="#__codelineno-0-60"> 60</a></span>
<span class="normal"><a href="#__codelineno-0-61"> 61</a></span>
<span class="normal"><a href="#__codelineno-0-62"> 62</a></span>
<span class="normal"><a href="#__codelineno-0-63"> 63</a></span>
<span class="normal"><a href="#__codelineno-0-64"> 64</a></span>
<span class="normal"><a href="#__codelineno-0-65"> 65</a></span>
<span class="normal"><a href="#__codelineno-0-66"> 66</a></span>
<span class="normal"><a href="#__codelineno-0-67"> 67</a></span>
<span class="normal"><a href="#__codelineno-0-68"> 68</a></span>
<span class="normal"><a href="#__codelineno-0-69"> 69</a></span>
<span class="normal"><a href="#__codelineno-0-70"> 70</a></span>
<span class="normal"><a href="#__codelineno-0-71"> 71</a></span>
<span class="normal"><a href="#__codelineno-0-72"> 72</a></span>
<span class="normal"><a href="#__codelineno-0-73"> 73</a></span>
<span class="normal"><a href="#__codelineno-0-74"> 74</a></span>
<span class="normal"><a href="#__codelineno-0-75"> 75</a></span>
<span class="normal"><a href="#__codelineno-0-76"> 76</a></span>
<span class="normal"><a href="#__codelineno-0-77"> 77</a></span>
<span class="normal"><a href="#__codelineno-0-78"> 78</a></span>
<span class="normal"><a href="#__codelineno-0-79"> 79</a></span>
<span class="normal"><a href="#__codelineno-0-80"> 80</a></span>
<span class="normal"><a href="#__codelineno-0-81"> 81</a></span>
<span class="normal"><a href="#__codelineno-0-82"> 82</a></span>
<span class="normal"><a href="#__codelineno-0-83"> 83</a></span>
<span class="normal"><a href="#__codelineno-0-84"> 84</a></span>
<span class="normal"><a href="#__codelineno-0-85"> 85</a></span>
<span class="normal"><a href="#__codelineno-0-86"> 86</a></span>
<span class="normal"><a href="#__codelineno-0-87"> 87</a></span>
<span class="normal"><a href="#__codelineno-0-88"> 88</a></span>
<span class="normal"><a href="#__codelineno-0-89"> 89</a></span>
<span class="normal"><a href="#__codelineno-0-90"> 90</a></span>
<span class="normal"><a href="#__codelineno-0-91"> 91</a></span>
<span class="normal"><a href="#__codelineno-0-92"> 92</a></span>
<span class="normal"><a href="#__codelineno-0-93"> 93</a></span>
<span class="normal"><a href="#__codelineno-0-94"> 94</a></span>
<span class="normal"><a href="#__codelineno-0-95"> 95</a></span>
<span class="normal"><a href="#__codelineno-0-96"> 96</a></span>
<span class="normal"><a href="#__codelineno-0-97"> 97</a></span>
<span class="normal"><a href="#__codelineno-0-98"> 98</a></span>
<span class="normal"><a href="#__codelineno-0-99"> 99</a></span>
<span class="normal"><a href="#__codelineno-0-100">100</a></span>
<span class="normal"><a href="#__codelineno-0-101">101</a></span>
<span class="normal"><a href="#__codelineno-0-102">102</a></span>
<span class="normal"><a href="#__codelineno-0-103">103</a></span>
<span class="normal"><a href="#__codelineno-0-104">104</a></span>
<span class="normal"><a href="#__codelineno-0-105">105</a></span>
<span class="normal"><a href="#__codelineno-0-106">106</a></span>
<span class="normal"><a href="#__codelineno-0-107">107</a></span>
<span class="normal"><a href="#__codelineno-0-108">108</a></span>
<span class="normal"><a href="#__codelineno-0-109">109</a></span>
<span class="normal"><a href="#__codelineno-0-110">110</a></span>
<span class="normal"><a href="#__codelineno-0-111">111</a></span>
<span class="normal"><a href="#__codelineno-0-112">112</a></span>
<span class="normal"><a href="#__codelineno-0-113">113</a></span>
<span class="normal"><a href="#__codelineno-0-114">114</a></span>
<span class="normal"><a href="#__codelineno-0-115">115</a></span>
<span class="normal"><a href="#__codelineno-0-116">116</a></span>
<span class="normal"><a href="#__codelineno-0-117">117</a></span>
<span class="normal"><a href="#__codelineno-0-118">118</a></span>
<span class="normal"><a href="#__codelineno-0-119">119</a></span>
<span class="normal"><a href="#__codelineno-0-120">120</a></span>
<span class="normal"><a href="#__codelineno-0-121">121</a></span>
<span class="normal"><a href="#__codelineno-0-122">122</a></span>
<span class="normal"><a href="#__codelineno-0-123">123</a></span>
<span class="normal"><a href="#__codelineno-0-124">124</a></span>
<span class="normal"><a href="#__codelineno-0-125">125</a></span>
<span class="normal"><a href="#__codelineno-0-126">126</a></span>
<span class="normal"><a href="#__codelineno-0-127">127</a></span>
<span class="normal"><a href="#__codelineno-0-128">128</a></span>
<span class="normal"><a href="#__codelineno-0-129">129</a></span>
<span class="normal"><a href="#__codelineno-0-130">130</a></span>
<span class="normal"><a href="#__codelineno-0-131">131</a></span>
<span class="normal"><a href="#__codelineno-0-132">132</a></span>
<span class="normal"><a href="#__codelineno-0-133">133</a></span>
<span class="normal"><a href="#__codelineno-0-134">134</a></span>
<span class="normal"><a href="#__codelineno-0-135">135</a></span>
<span class="normal"><a href="#__codelineno-0-136">136</a></span>
<span class="normal"><a href="#__codelineno-0-137">137</a></span>
<span class="normal"><a href="#__codelineno-0-138">138</a></span>
<span class="normal"><a href="#__codelineno-0-139">139</a></span>
<span class="normal"><a href="#__codelineno-0-140">140</a></span>
<span class="normal"><a href="#__codelineno-0-141">141</a></span>
<span class="normal"><a href="#__codelineno-0-142">142</a></span>
<span class="normal"><a href="#__codelineno-0-143">143</a></span>
<span class="normal"><a href="#__codelineno-0-144">144</a></span>
<span class="normal"><a href="#__codelineno-0-145">145</a></span>
<span class="normal"><a href="#__codelineno-0-146">146</a></span>
<span class="normal"><a href="#__codelineno-0-147">147</a></span>
<span class="normal"><a href="#__codelineno-0-148">148</a></span>
<span class="normal"><a href="#__codelineno-0-149">149</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-45" name="__codelineno-0-45"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-46" name="__codelineno-0-46"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-47" name="__codelineno-0-47"></a>    <span class="n">camera_file</span><span class="p">:</span> <span class="n">PATH_TYPE</span><span class="p">,</span>
<a id="__codelineno-0-48" name="__codelineno-0-48"></a>    <span class="n">image_folder</span><span class="p">:</span> <span class="n">PATH_TYPE</span><span class="p">,</span>
<a id="__codelineno-0-49" name="__codelineno-0-49"></a>    <span class="n">original_image_folder</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Optional</span><span class="p">[</span><span class="n">PATH_TYPE</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-50" name="__codelineno-0-50"></a>    <span class="n">validate_images</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-51" name="__codelineno-0-51"></a>    <span class="n">default_sensor_params</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;cx&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;cy&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">},</span>
<a id="__codelineno-0-52" name="__codelineno-0-52"></a><span class="p">):</span>
<a id="__codelineno-0-53" name="__codelineno-0-53"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;Parse the information about the camera intrinsics and extrinsics</span>
<a id="__codelineno-0-54" name="__codelineno-0-54"></a>
<a id="__codelineno-0-55" name="__codelineno-0-55"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-56" name="__codelineno-0-56"></a><span class="sd">        camera_file (PATH_TYPE):</span>
<a id="__codelineno-0-57" name="__codelineno-0-57"></a><span class="sd">            Path to metashape .xml export</span>
<a id="__codelineno-0-58" name="__codelineno-0-58"></a><span class="sd">        image_folder (PATH_TYPE):</span>
<a id="__codelineno-0-59" name="__codelineno-0-59"></a><span class="sd">            Path to image folder root</span>
<a id="__codelineno-0-60" name="__codelineno-0-60"></a><span class="sd">        original_image_folder (PATH_TYPE, optional):</span>
<a id="__codelineno-0-61" name="__codelineno-0-61"></a><span class="sd">            Path to where the original images for photogrammetry were, which was not included</span>
<a id="__codelineno-0-62" name="__codelineno-0-62"></a><span class="sd">            in the stored image zip files. This is removed from the absolute path recorded in</span>
<a id="__codelineno-0-63" name="__codelineno-0-63"></a><span class="sd">            the camera file. Defaults to None.</span>
<a id="__codelineno-0-64" name="__codelineno-0-64"></a><span class="sd">        validate_images (bool, optional): Should the existance of the images be checked.</span>
<a id="__codelineno-0-65" name="__codelineno-0-65"></a><span class="sd">            Any image_filenames found in the camera_file that do not exist on disk will be</span>
<a id="__codelineno-0-66" name="__codelineno-0-66"></a><span class="sd">            dropped, leaving a CameraSet only containing existing images. Defaults to False.</span>
<a id="__codelineno-0-67" name="__codelineno-0-67"></a><span class="sd">        default_sensor_params (dict, optional):</span>
<a id="__codelineno-0-68" name="__codelineno-0-68"></a><span class="sd">            Default parameters for the intrinsic parameters if not present. Defaults to zeros</span>
<a id="__codelineno-0-69" name="__codelineno-0-69"></a><span class="sd">            &quot;cx&quot; and &quot;cy&quot;.</span>
<a id="__codelineno-0-70" name="__codelineno-0-70"></a>
<a id="__codelineno-0-71" name="__codelineno-0-71"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-72" name="__codelineno-0-72"></a><span class="sd">        ValueError: If camera calibration does not contain the f, cx, and cy params</span>
<a id="__codelineno-0-73" name="__codelineno-0-73"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-74" name="__codelineno-0-74"></a>    <span class="c1"># Load the xml file</span>
<a id="__codelineno-0-75" name="__codelineno-0-75"></a>    <span class="c1"># Taken from here https://rowelldionicio.com/parsing-xml-with-python-minidom/</span>
<a id="__codelineno-0-76" name="__codelineno-0-76"></a>    <span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">camera_file</span><span class="p">)</span>
<a id="__codelineno-0-77" name="__codelineno-0-77"></a>    <span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
<a id="__codelineno-0-78" name="__codelineno-0-78"></a>    <span class="c1"># first level</span>
<a id="__codelineno-0-79" name="__codelineno-0-79"></a>    <span class="n">chunk</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;chunk&quot;</span><span class="p">)</span>
<a id="__codelineno-0-80" name="__codelineno-0-80"></a>    <span class="c1"># second level</span>
<a id="__codelineno-0-81" name="__codelineno-0-81"></a>    <span class="n">sensors</span> <span class="o">=</span> <span class="n">chunk</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;sensors&quot;</span><span class="p">)</span>
<a id="__codelineno-0-82" name="__codelineno-0-82"></a>    <span class="c1"># Parse the sensors representation</span>
<a id="__codelineno-0-83" name="__codelineno-0-83"></a>    <span class="n">sensors_dict</span> <span class="o">=</span> <span class="n">parse_sensors</span><span class="p">(</span><span class="n">sensors</span><span class="p">,</span> <span class="n">default_sensor_dict</span><span class="o">=</span><span class="n">default_sensor_params</span><span class="p">)</span>
<a id="__codelineno-0-84" name="__codelineno-0-84"></a>    <span class="c1"># Set up the lists to populate</span>
<a id="__codelineno-0-85" name="__codelineno-0-85"></a>    <span class="n">image_filenames</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-86" name="__codelineno-0-86"></a>    <span class="n">cam_to_world_transforms</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-87" name="__codelineno-0-87"></a>    <span class="n">sensor_IDs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-88" name="__codelineno-0-88"></a>
<a id="__codelineno-0-89" name="__codelineno-0-89"></a>    <span class="n">cameras</span> <span class="o">=</span> <span class="n">chunk</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<a id="__codelineno-0-90" name="__codelineno-0-90"></a>    <span class="c1"># Iterate over metashape cameras and fill out required information</span>
<a id="__codelineno-0-91" name="__codelineno-0-91"></a>    <span class="k">for</span> <span class="n">cam_or_group</span> <span class="ow">in</span> <span class="n">cameras</span><span class="p">:</span>
<a id="__codelineno-0-92" name="__codelineno-0-92"></a>        <span class="k">if</span> <span class="n">cam_or_group</span><span class="o">.</span><span class="n">tag</span> <span class="o">==</span> <span class="s2">&quot;group&quot;</span><span class="p">:</span>
<a id="__codelineno-0-93" name="__codelineno-0-93"></a>            <span class="k">for</span> <span class="n">cam</span> <span class="ow">in</span> <span class="n">cam_or_group</span><span class="p">:</span>
<a id="__codelineno-0-94" name="__codelineno-0-94"></a>                <span class="n">update_lists</span><span class="p">(</span>
<a id="__codelineno-0-95" name="__codelineno-0-95"></a>                    <span class="n">cam</span><span class="p">,</span>
<a id="__codelineno-0-96" name="__codelineno-0-96"></a>                    <span class="n">image_folder</span><span class="p">,</span>
<a id="__codelineno-0-97" name="__codelineno-0-97"></a>                    <span class="n">cam_to_world_transforms</span><span class="p">,</span>
<a id="__codelineno-0-98" name="__codelineno-0-98"></a>                    <span class="n">image_filenames</span><span class="p">,</span>
<a id="__codelineno-0-99" name="__codelineno-0-99"></a>                    <span class="n">sensor_IDs</span><span class="p">,</span>
<a id="__codelineno-0-100" name="__codelineno-0-100"></a>                    <span class="n">original_image_folder</span><span class="o">=</span><span class="n">original_image_folder</span><span class="p">,</span>
<a id="__codelineno-0-101" name="__codelineno-0-101"></a>                <span class="p">)</span>
<a id="__codelineno-0-102" name="__codelineno-0-102"></a>        <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-103" name="__codelineno-0-103"></a>            <span class="n">update_lists</span><span class="p">(</span>
<a id="__codelineno-0-104" name="__codelineno-0-104"></a>                <span class="n">cam_or_group</span><span class="p">,</span>
<a id="__codelineno-0-105" name="__codelineno-0-105"></a>                <span class="n">image_folder</span><span class="p">,</span>
<a id="__codelineno-0-106" name="__codelineno-0-106"></a>                <span class="n">cam_to_world_transforms</span><span class="p">,</span>
<a id="__codelineno-0-107" name="__codelineno-0-107"></a>                <span class="n">image_filenames</span><span class="p">,</span>
<a id="__codelineno-0-108" name="__codelineno-0-108"></a>                <span class="n">sensor_IDs</span><span class="p">,</span>
<a id="__codelineno-0-109" name="__codelineno-0-109"></a>                <span class="n">original_image_folder</span><span class="o">=</span><span class="n">original_image_folder</span><span class="p">,</span>
<a id="__codelineno-0-110" name="__codelineno-0-110"></a>            <span class="p">)</span>
<a id="__codelineno-0-111" name="__codelineno-0-111"></a>
<a id="__codelineno-0-112" name="__codelineno-0-112"></a>    <span class="c1"># Compute the lat lon using the transforms, because the reference values recorded in the file</span>
<a id="__codelineno-0-113" name="__codelineno-0-113"></a>    <span class="c1"># reflect the EXIF values, not the optimized ones</span>
<a id="__codelineno-0-114" name="__codelineno-0-114"></a>
<a id="__codelineno-0-115" name="__codelineno-0-115"></a>    <span class="c1"># Get the transform from the chunk to the earth-centered, earth-fixed (ECEF) frame</span>
<a id="__codelineno-0-116" name="__codelineno-0-116"></a>    <span class="n">chunk_to_epsg4978</span> <span class="o">=</span> <span class="n">parse_transform_metashape</span><span class="p">(</span><span class="n">camera_file</span><span class="o">=</span><span class="n">camera_file</span><span class="p">)</span>
<a id="__codelineno-0-117" name="__codelineno-0-117"></a>
<a id="__codelineno-0-118" name="__codelineno-0-118"></a>    <span class="k">if</span> <span class="n">chunk_to_epsg4978</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-0-119" name="__codelineno-0-119"></a>        <span class="c1"># Compute the location of each camera in ECEF</span>
<a id="__codelineno-0-120" name="__codelineno-0-120"></a>        <span class="n">cam_locs_in_epsg4978</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-121" name="__codelineno-0-121"></a>        <span class="k">for</span> <span class="n">cam_to_world_transform</span> <span class="ow">in</span> <span class="n">cam_to_world_transforms</span><span class="p">:</span>
<a id="__codelineno-0-122" name="__codelineno-0-122"></a>            <span class="n">cam_loc_in_chunk</span> <span class="o">=</span> <span class="n">cam_to_world_transform</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">:]</span>
<a id="__codelineno-0-123" name="__codelineno-0-123"></a>            <span class="n">cam_locs_in_epsg4978</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">chunk_to_epsg4978</span> <span class="o">@</span> <span class="n">cam_loc_in_chunk</span><span class="p">)</span>
<a id="__codelineno-0-124" name="__codelineno-0-124"></a>        <span class="n">cam_locs_in_epsg4978</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">cam_locs_in_epsg4978</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)[:</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">T</span>
<a id="__codelineno-0-125" name="__codelineno-0-125"></a>        <span class="c1"># Transform these points into lat-lon-alt</span>
<a id="__codelineno-0-126" name="__codelineno-0-126"></a>        <span class="n">transformer</span> <span class="o">=</span> <span class="n">pyproj</span><span class="o">.</span><span class="n">Transformer</span><span class="o">.</span><span class="n">from_crs</span><span class="p">(</span>
<a id="__codelineno-0-127" name="__codelineno-0-127"></a>            <span class="n">EARTH_CENTERED_EARTH_FIXED_CRS</span><span class="p">,</span> <span class="n">LAT_LON_CRS</span>
<a id="__codelineno-0-128" name="__codelineno-0-128"></a>        <span class="p">)</span>
<a id="__codelineno-0-129" name="__codelineno-0-129"></a>        <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span>
<a id="__codelineno-0-130" name="__codelineno-0-130"></a>            <span class="n">xx</span><span class="o">=</span><span class="n">cam_locs_in_epsg4978</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span>
<a id="__codelineno-0-131" name="__codelineno-0-131"></a>            <span class="n">yy</span><span class="o">=</span><span class="n">cam_locs_in_epsg4978</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span>
<a id="__codelineno-0-132" name="__codelineno-0-132"></a>            <span class="n">zz</span><span class="o">=</span><span class="n">cam_locs_in_epsg4978</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span>
<a id="__codelineno-0-133" name="__codelineno-0-133"></a>        <span class="p">)</span>
<a id="__codelineno-0-134" name="__codelineno-0-134"></a>        <span class="n">lon_lats</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">))</span>
<a id="__codelineno-0-135" name="__codelineno-0-135"></a>    <span class="k">else</span><span class="p">:</span>
<a id="__codelineno-0-136" name="__codelineno-0-136"></a>        <span class="c1"># TODO consider trying to parse from the xml</span>
<a id="__codelineno-0-137" name="__codelineno-0-137"></a>        <span class="n">lon_lats</span> <span class="o">=</span> <span class="kc">None</span>
<a id="__codelineno-0-138" name="__codelineno-0-138"></a>
<a id="__codelineno-0-139" name="__codelineno-0-139"></a>    <span class="c1"># Actually construct the camera objects using the base class</span>
<a id="__codelineno-0-140" name="__codelineno-0-140"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-141" name="__codelineno-0-141"></a>        <span class="n">cam_to_world_transforms</span><span class="o">=</span><span class="n">cam_to_world_transforms</span><span class="p">,</span>
<a id="__codelineno-0-142" name="__codelineno-0-142"></a>        <span class="n">intrinsic_params_per_sensor_type</span><span class="o">=</span><span class="n">sensors_dict</span><span class="p">,</span>
<a id="__codelineno-0-143" name="__codelineno-0-143"></a>        <span class="n">image_filenames</span><span class="o">=</span><span class="n">image_filenames</span><span class="p">,</span>
<a id="__codelineno-0-144" name="__codelineno-0-144"></a>        <span class="n">lon_lats</span><span class="o">=</span><span class="n">lon_lats</span><span class="p">,</span>
<a id="__codelineno-0-145" name="__codelineno-0-145"></a>        <span class="n">image_folder</span><span class="o">=</span><span class="n">image_folder</span><span class="p">,</span>
<a id="__codelineno-0-146" name="__codelineno-0-146"></a>        <span class="n">sensor_IDs</span><span class="o">=</span><span class="n">sensor_IDs</span><span class="p">,</span>
<a id="__codelineno-0-147" name="__codelineno-0-147"></a>        <span class="n">validate_images</span><span class="o">=</span><span class="n">validate_images</span><span class="p">,</span>
<a id="__codelineno-0-148" name="__codelineno-0-148"></a>        <span class="n">local_to_epsg_4978_transform</span><span class="o">=</span><span class="n">chunk_to_epsg4978</span><span class="p">,</span>
<a id="__codelineno-0-149" name="__codelineno-0-149"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="geograypher.cameras.derived_cameras.COLMAPCameraSet" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-class"></code>            <code>COLMAPCameraSet</code>


<a href="#geograypher.cameras.derived_cameras.COLMAPCameraSet" class="headerlink" title="Permanent link">&para;</a></h2>


    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="            PhotogrammetryCameraSet (geograypher.cameras.PhotogrammetryCameraSet)" href="../cameras/#geograypher.cameras.PhotogrammetryCameraSet">PhotogrammetryCameraSet</a></code></p>









              <details class="quote">
                <summary>Source code in <code>geograypher/cameras/derived_cameras.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-152">152</a></span>
<span class="normal"><a href="#__codelineno-0-153">153</a></span>
<span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-152" name="__codelineno-0-152"></a><span class="k">class</span><span class="w"> </span><span class="nc">COLMAPCameraSet</span><span class="p">(</span><span class="n">PhotogrammetryCameraSet</span><span class="p">):</span>
<a id="__codelineno-0-153" name="__codelineno-0-153"></a>
<a id="__codelineno-0-154" name="__codelineno-0-154"></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>        <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>        <span class="n">cameras_file</span><span class="p">:</span> <span class="n">PATH_TYPE</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>        <span class="n">images_file</span><span class="p">:</span> <span class="n">PATH_TYPE</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>        <span class="n">image_folder</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">PATH_TYPE</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>        <span class="n">validate_images</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a>    <span class="p">):</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">        Create a camera set from the files exported by the open-source structure-from-motion</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">        software COLMAP as defined here: https://colmap.github.io/format.html</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">        Args:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">            cameras_file (PATH_TYPE):</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">                Path to the file containing the camera models definitions</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">            images_file (PATH_TYPE):</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">                Path to the per-image information, including the pose and which camera model is used</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">            image_folder (typing.Union[None, PATH_TYPE], optional):</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">                Path to the folder of images used to generate the reconstruction. Defaults to None.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">            validate_images (bool, optional):</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">                Ensure that the images described in images_file are present in image_folder.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">                Defaults to False.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">        Raises:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">            NotImplementedError: If the camera is not a Simple radial model</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">        &quot;&quot;&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>        <span class="c1"># Parse the csv representation of the camera models</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>        <span class="n">cameras_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>            <span class="n">cameras_file</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>            <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>            <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>            <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>            <span class="n">names</span><span class="o">=</span><span class="p">(</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>                <span class="s2">&quot;CAMERA_ID&quot;</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>                <span class="s2">&quot;MODEL&quot;</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>                <span class="s2">&quot;WIDTH&quot;</span><span class="p">,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>                <span class="s2">&quot;HEIGHT&quot;</span><span class="p">,</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>                <span class="s2">&quot;PARAMS_F&quot;</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>                <span class="s2">&quot;PARAMS_CX&quot;</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>                <span class="s2">&quot;PARAMS_CY&quot;</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>                <span class="s2">&quot;PARAMS_RADIAL&quot;</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>            <span class="p">),</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>        <span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>        <span class="c1"># Parse the csv of the per-image information</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>        <span class="c1"># Note that every image has first the useful information on one row and then unneeded</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>        <span class="c1"># keypoint information on the following row. Therefore, the keypoints are discarded.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>        <span class="n">images_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>            <span class="n">images_file</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>            <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>            <span class="n">skiprows</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>            <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>            <span class="n">names</span><span class="o">=</span><span class="p">(</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>                <span class="s2">&quot;IMAGE_ID&quot;</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>                <span class="s2">&quot;QW&quot;</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>                <span class="s2">&quot;QX&quot;</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>                <span class="s2">&quot;QY&quot;</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>                <span class="s2">&quot;QZ&quot;</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>                <span class="s2">&quot;TX&quot;</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>                <span class="s2">&quot;TY&quot;</span><span class="p">,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>                <span class="s2">&quot;TZ&quot;</span><span class="p">,</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>                <span class="s2">&quot;CAMERA_ID&quot;</span><span class="p">,</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>                <span class="s2">&quot;NAME&quot;</span><span class="p">,</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>            <span class="p">),</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>            <span class="n">usecols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>        <span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>        <span class="c1"># TODO support more camera models</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">cameras_data</span><span class="p">[</span><span class="s2">&quot;MODEL&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;SIMPLE_RADIAL&quot;</span><span class="p">):</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Not a supported camera model&quot;</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>        <span class="c1"># Parse the camera parameters, creating a dict for each distinct camera model</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>        <span class="n">sensors_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cameras_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>            <span class="c1"># Note that the convention in this tool is for cx, cy to be defined from the center</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>            <span class="c1"># not the corner so it must be shifted</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>            <span class="n">sensor_dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>                <span class="s2">&quot;image_width&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;WIDTH&quot;</span><span class="p">],</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>                <span class="s2">&quot;image_height&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;HEIGHT&quot;</span><span class="p">],</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>                <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PARAMS_F&quot;</span><span class="p">],</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>                <span class="s2">&quot;cx&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PARAMS_CX&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;WIDTH&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>                <span class="s2">&quot;cy&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PARAMS_CY&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;HEIGHT&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>                <span class="s2">&quot;distortion_params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PARAMS_RADIAL&quot;</span><span class="p">]},</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>            <span class="p">}</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>            <span class="n">sensors_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;CAMERA_ID&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">sensor_dict</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>        <span class="c1"># Parse the per-image information</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>        <span class="n">cam_to_world_transforms</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>        <span class="n">sensor_IDs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>        <span class="n">image_filenames</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">images_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>            <span class="c1"># Convert from the quaternion representation to the matrix one. Note that the W element</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>            <span class="c1"># is the first one in the COLMAP convention but the last one in scipy.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>            <span class="n">rot_mat</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>                <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;QX&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;QY&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;QZ&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;QW&quot;</span><span class="p">])</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>            <span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>            <span class="c1"># Get the camera translation</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>            <span class="n">translation_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;TX&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;TY&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;TZ&quot;</span><span class="p">]])</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>            <span class="c1"># Create a 4x4 homogenous matrix representing the world_to_cam transform</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>            <span class="n">world_to_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>            <span class="c1"># Populate the sub-elements</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>            <span class="n">world_to_cam</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_mat</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>            <span class="n">world_to_cam</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">translation_vec</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>            <span class="c1"># We need the cam to world transform. Since we&#39;re using a 4x4 representation, we can</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>            <span class="c1"># just invert the matrix</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>            <span class="n">cam_to_world</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">world_to_cam</span><span class="p">)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>            <span class="n">cam_to_world_transforms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cam_to_world</span><span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>            <span class="c1"># Record which camera model is used and the image filename</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>            <span class="n">sensor_IDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;CAMERA_ID&quot;</span><span class="p">])</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>            <span class="n">image_filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">image_folder</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;NAME&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>        <span class="c1"># Instantiate the camera set</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>            <span class="n">cam_to_world_transforms</span><span class="o">=</span><span class="n">cam_to_world_transforms</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>            <span class="n">intrinsic_params_per_sensor_type</span><span class="o">=</span><span class="n">sensors_dict</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>            <span class="n">image_filenames</span><span class="o">=</span><span class="n">image_filenames</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>            <span class="n">sensor_IDs</span><span class="o">=</span><span class="n">sensor_IDs</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>            <span class="n">image_folder</span><span class="o">=</span><span class="n">image_folder</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>            <span class="n">validate_images</span><span class="o">=</span><span class="n">validate_images</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">








<h3 id="geograypher.cameras.derived_cameras.COLMAPCameraSet-functions">Functions<a href="#geograypher.cameras.derived_cameras.COLMAPCameraSet-functions" class="headerlink" title="Permanent link">&para;</a></h3>

<div class="doc doc-object doc-function">


<h4 id="geograypher.cameras.derived_cameras.COLMAPCameraSet.__init__" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-method"></code>            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">cameras_file</span><span class="p">,</span> <span class="n">images_file</span><span class="p">,</span> <span class="n">image_folder</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">validate_images</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#geograypher.cameras.derived_cameras.COLMAPCameraSet.__init__" class="headerlink" title="Permanent link">&para;</a></h4>


    <div class="doc doc-contents ">

        <p>Create a camera set from the files exported by the open-source structure-from-motion
software COLMAP as defined here: https://colmap.github.io/format.html</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>cameras_file</code>
            </td>
            <td>
                  <code><span title="geograypher.constants.PATH_TYPE">PATH_TYPE</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the file containing the camera models definitions</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>images_file</code>
            </td>
            <td>
                  <code><span title="geograypher.constants.PATH_TYPE">PATH_TYPE</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the per-image information, including the pose and which camera model is used</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>image_folder</code>
            </td>
            <td>
                  <code><span title="typing.Union">Union</span>[None, <span title="geograypher.constants.PATH_TYPE">PATH_TYPE</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the folder of images used to generate the reconstruction. Defaults to None.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>validate_images</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Ensure that the images described in images_file are present in image_folder.
Defaults to False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="NotImplementedError">NotImplementedError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If the camera is not a Simple radial model</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>geograypher/cameras/derived_cameras.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-0-154">154</a></span>
<span class="normal"><a href="#__codelineno-0-155">155</a></span>
<span class="normal"><a href="#__codelineno-0-156">156</a></span>
<span class="normal"><a href="#__codelineno-0-157">157</a></span>
<span class="normal"><a href="#__codelineno-0-158">158</a></span>
<span class="normal"><a href="#__codelineno-0-159">159</a></span>
<span class="normal"><a href="#__codelineno-0-160">160</a></span>
<span class="normal"><a href="#__codelineno-0-161">161</a></span>
<span class="normal"><a href="#__codelineno-0-162">162</a></span>
<span class="normal"><a href="#__codelineno-0-163">163</a></span>
<span class="normal"><a href="#__codelineno-0-164">164</a></span>
<span class="normal"><a href="#__codelineno-0-165">165</a></span>
<span class="normal"><a href="#__codelineno-0-166">166</a></span>
<span class="normal"><a href="#__codelineno-0-167">167</a></span>
<span class="normal"><a href="#__codelineno-0-168">168</a></span>
<span class="normal"><a href="#__codelineno-0-169">169</a></span>
<span class="normal"><a href="#__codelineno-0-170">170</a></span>
<span class="normal"><a href="#__codelineno-0-171">171</a></span>
<span class="normal"><a href="#__codelineno-0-172">172</a></span>
<span class="normal"><a href="#__codelineno-0-173">173</a></span>
<span class="normal"><a href="#__codelineno-0-174">174</a></span>
<span class="normal"><a href="#__codelineno-0-175">175</a></span>
<span class="normal"><a href="#__codelineno-0-176">176</a></span>
<span class="normal"><a href="#__codelineno-0-177">177</a></span>
<span class="normal"><a href="#__codelineno-0-178">178</a></span>
<span class="normal"><a href="#__codelineno-0-179">179</a></span>
<span class="normal"><a href="#__codelineno-0-180">180</a></span>
<span class="normal"><a href="#__codelineno-0-181">181</a></span>
<span class="normal"><a href="#__codelineno-0-182">182</a></span>
<span class="normal"><a href="#__codelineno-0-183">183</a></span>
<span class="normal"><a href="#__codelineno-0-184">184</a></span>
<span class="normal"><a href="#__codelineno-0-185">185</a></span>
<span class="normal"><a href="#__codelineno-0-186">186</a></span>
<span class="normal"><a href="#__codelineno-0-187">187</a></span>
<span class="normal"><a href="#__codelineno-0-188">188</a></span>
<span class="normal"><a href="#__codelineno-0-189">189</a></span>
<span class="normal"><a href="#__codelineno-0-190">190</a></span>
<span class="normal"><a href="#__codelineno-0-191">191</a></span>
<span class="normal"><a href="#__codelineno-0-192">192</a></span>
<span class="normal"><a href="#__codelineno-0-193">193</a></span>
<span class="normal"><a href="#__codelineno-0-194">194</a></span>
<span class="normal"><a href="#__codelineno-0-195">195</a></span>
<span class="normal"><a href="#__codelineno-0-196">196</a></span>
<span class="normal"><a href="#__codelineno-0-197">197</a></span>
<span class="normal"><a href="#__codelineno-0-198">198</a></span>
<span class="normal"><a href="#__codelineno-0-199">199</a></span>
<span class="normal"><a href="#__codelineno-0-200">200</a></span>
<span class="normal"><a href="#__codelineno-0-201">201</a></span>
<span class="normal"><a href="#__codelineno-0-202">202</a></span>
<span class="normal"><a href="#__codelineno-0-203">203</a></span>
<span class="normal"><a href="#__codelineno-0-204">204</a></span>
<span class="normal"><a href="#__codelineno-0-205">205</a></span>
<span class="normal"><a href="#__codelineno-0-206">206</a></span>
<span class="normal"><a href="#__codelineno-0-207">207</a></span>
<span class="normal"><a href="#__codelineno-0-208">208</a></span>
<span class="normal"><a href="#__codelineno-0-209">209</a></span>
<span class="normal"><a href="#__codelineno-0-210">210</a></span>
<span class="normal"><a href="#__codelineno-0-211">211</a></span>
<span class="normal"><a href="#__codelineno-0-212">212</a></span>
<span class="normal"><a href="#__codelineno-0-213">213</a></span>
<span class="normal"><a href="#__codelineno-0-214">214</a></span>
<span class="normal"><a href="#__codelineno-0-215">215</a></span>
<span class="normal"><a href="#__codelineno-0-216">216</a></span>
<span class="normal"><a href="#__codelineno-0-217">217</a></span>
<span class="normal"><a href="#__codelineno-0-218">218</a></span>
<span class="normal"><a href="#__codelineno-0-219">219</a></span>
<span class="normal"><a href="#__codelineno-0-220">220</a></span>
<span class="normal"><a href="#__codelineno-0-221">221</a></span>
<span class="normal"><a href="#__codelineno-0-222">222</a></span>
<span class="normal"><a href="#__codelineno-0-223">223</a></span>
<span class="normal"><a href="#__codelineno-0-224">224</a></span>
<span class="normal"><a href="#__codelineno-0-225">225</a></span>
<span class="normal"><a href="#__codelineno-0-226">226</a></span>
<span class="normal"><a href="#__codelineno-0-227">227</a></span>
<span class="normal"><a href="#__codelineno-0-228">228</a></span>
<span class="normal"><a href="#__codelineno-0-229">229</a></span>
<span class="normal"><a href="#__codelineno-0-230">230</a></span>
<span class="normal"><a href="#__codelineno-0-231">231</a></span>
<span class="normal"><a href="#__codelineno-0-232">232</a></span>
<span class="normal"><a href="#__codelineno-0-233">233</a></span>
<span class="normal"><a href="#__codelineno-0-234">234</a></span>
<span class="normal"><a href="#__codelineno-0-235">235</a></span>
<span class="normal"><a href="#__codelineno-0-236">236</a></span>
<span class="normal"><a href="#__codelineno-0-237">237</a></span>
<span class="normal"><a href="#__codelineno-0-238">238</a></span>
<span class="normal"><a href="#__codelineno-0-239">239</a></span>
<span class="normal"><a href="#__codelineno-0-240">240</a></span>
<span class="normal"><a href="#__codelineno-0-241">241</a></span>
<span class="normal"><a href="#__codelineno-0-242">242</a></span>
<span class="normal"><a href="#__codelineno-0-243">243</a></span>
<span class="normal"><a href="#__codelineno-0-244">244</a></span>
<span class="normal"><a href="#__codelineno-0-245">245</a></span>
<span class="normal"><a href="#__codelineno-0-246">246</a></span>
<span class="normal"><a href="#__codelineno-0-247">247</a></span>
<span class="normal"><a href="#__codelineno-0-248">248</a></span>
<span class="normal"><a href="#__codelineno-0-249">249</a></span>
<span class="normal"><a href="#__codelineno-0-250">250</a></span>
<span class="normal"><a href="#__codelineno-0-251">251</a></span>
<span class="normal"><a href="#__codelineno-0-252">252</a></span>
<span class="normal"><a href="#__codelineno-0-253">253</a></span>
<span class="normal"><a href="#__codelineno-0-254">254</a></span>
<span class="normal"><a href="#__codelineno-0-255">255</a></span>
<span class="normal"><a href="#__codelineno-0-256">256</a></span>
<span class="normal"><a href="#__codelineno-0-257">257</a></span>
<span class="normal"><a href="#__codelineno-0-258">258</a></span>
<span class="normal"><a href="#__codelineno-0-259">259</a></span>
<span class="normal"><a href="#__codelineno-0-260">260</a></span>
<span class="normal"><a href="#__codelineno-0-261">261</a></span>
<span class="normal"><a href="#__codelineno-0-262">262</a></span>
<span class="normal"><a href="#__codelineno-0-263">263</a></span>
<span class="normal"><a href="#__codelineno-0-264">264</a></span>
<span class="normal"><a href="#__codelineno-0-265">265</a></span>
<span class="normal"><a href="#__codelineno-0-266">266</a></span>
<span class="normal"><a href="#__codelineno-0-267">267</a></span>
<span class="normal"><a href="#__codelineno-0-268">268</a></span>
<span class="normal"><a href="#__codelineno-0-269">269</a></span>
<span class="normal"><a href="#__codelineno-0-270">270</a></span>
<span class="normal"><a href="#__codelineno-0-271">271</a></span>
<span class="normal"><a href="#__codelineno-0-272">272</a></span>
<span class="normal"><a href="#__codelineno-0-273">273</a></span>
<span class="normal"><a href="#__codelineno-0-274">274</a></span></pre></div></td><td class="code"><div><pre><span></span><code><a id="__codelineno-0-154" name="__codelineno-0-154"></a><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-155" name="__codelineno-0-155"></a>    <span class="bp">self</span><span class="p">,</span>
<a id="__codelineno-0-156" name="__codelineno-0-156"></a>    <span class="n">cameras_file</span><span class="p">:</span> <span class="n">PATH_TYPE</span><span class="p">,</span>
<a id="__codelineno-0-157" name="__codelineno-0-157"></a>    <span class="n">images_file</span><span class="p">:</span> <span class="n">PATH_TYPE</span><span class="p">,</span>
<a id="__codelineno-0-158" name="__codelineno-0-158"></a>    <span class="n">image_folder</span><span class="p">:</span> <span class="n">typing</span><span class="o">.</span><span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">PATH_TYPE</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-159" name="__codelineno-0-159"></a>    <span class="n">validate_images</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<a id="__codelineno-0-160" name="__codelineno-0-160"></a><span class="p">):</span>
<a id="__codelineno-0-161" name="__codelineno-0-161"></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<a id="__codelineno-0-162" name="__codelineno-0-162"></a><span class="sd">    Create a camera set from the files exported by the open-source structure-from-motion</span>
<a id="__codelineno-0-163" name="__codelineno-0-163"></a><span class="sd">    software COLMAP as defined here: https://colmap.github.io/format.html</span>
<a id="__codelineno-0-164" name="__codelineno-0-164"></a>
<a id="__codelineno-0-165" name="__codelineno-0-165"></a><span class="sd">    Args:</span>
<a id="__codelineno-0-166" name="__codelineno-0-166"></a><span class="sd">        cameras_file (PATH_TYPE):</span>
<a id="__codelineno-0-167" name="__codelineno-0-167"></a><span class="sd">            Path to the file containing the camera models definitions</span>
<a id="__codelineno-0-168" name="__codelineno-0-168"></a><span class="sd">        images_file (PATH_TYPE):</span>
<a id="__codelineno-0-169" name="__codelineno-0-169"></a><span class="sd">            Path to the per-image information, including the pose and which camera model is used</span>
<a id="__codelineno-0-170" name="__codelineno-0-170"></a><span class="sd">        image_folder (typing.Union[None, PATH_TYPE], optional):</span>
<a id="__codelineno-0-171" name="__codelineno-0-171"></a><span class="sd">            Path to the folder of images used to generate the reconstruction. Defaults to None.</span>
<a id="__codelineno-0-172" name="__codelineno-0-172"></a><span class="sd">        validate_images (bool, optional):</span>
<a id="__codelineno-0-173" name="__codelineno-0-173"></a><span class="sd">            Ensure that the images described in images_file are present in image_folder.</span>
<a id="__codelineno-0-174" name="__codelineno-0-174"></a><span class="sd">            Defaults to False.</span>
<a id="__codelineno-0-175" name="__codelineno-0-175"></a>
<a id="__codelineno-0-176" name="__codelineno-0-176"></a><span class="sd">    Raises:</span>
<a id="__codelineno-0-177" name="__codelineno-0-177"></a><span class="sd">        NotImplementedError: If the camera is not a Simple radial model</span>
<a id="__codelineno-0-178" name="__codelineno-0-178"></a><span class="sd">    &quot;&quot;&quot;</span>
<a id="__codelineno-0-179" name="__codelineno-0-179"></a>    <span class="c1"># Parse the csv representation of the camera models</span>
<a id="__codelineno-0-180" name="__codelineno-0-180"></a>    <span class="n">cameras_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<a id="__codelineno-0-181" name="__codelineno-0-181"></a>        <span class="n">cameras_file</span><span class="p">,</span>
<a id="__codelineno-0-182" name="__codelineno-0-182"></a>        <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
<a id="__codelineno-0-183" name="__codelineno-0-183"></a>        <span class="n">skiprows</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
<a id="__codelineno-0-184" name="__codelineno-0-184"></a>        <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-185" name="__codelineno-0-185"></a>        <span class="n">names</span><span class="o">=</span><span class="p">(</span>
<a id="__codelineno-0-186" name="__codelineno-0-186"></a>            <span class="s2">&quot;CAMERA_ID&quot;</span><span class="p">,</span>
<a id="__codelineno-0-187" name="__codelineno-0-187"></a>            <span class="s2">&quot;MODEL&quot;</span><span class="p">,</span>
<a id="__codelineno-0-188" name="__codelineno-0-188"></a>            <span class="s2">&quot;WIDTH&quot;</span><span class="p">,</span>
<a id="__codelineno-0-189" name="__codelineno-0-189"></a>            <span class="s2">&quot;HEIGHT&quot;</span><span class="p">,</span>
<a id="__codelineno-0-190" name="__codelineno-0-190"></a>            <span class="s2">&quot;PARAMS_F&quot;</span><span class="p">,</span>
<a id="__codelineno-0-191" name="__codelineno-0-191"></a>            <span class="s2">&quot;PARAMS_CX&quot;</span><span class="p">,</span>
<a id="__codelineno-0-192" name="__codelineno-0-192"></a>            <span class="s2">&quot;PARAMS_CY&quot;</span><span class="p">,</span>
<a id="__codelineno-0-193" name="__codelineno-0-193"></a>            <span class="s2">&quot;PARAMS_RADIAL&quot;</span><span class="p">,</span>
<a id="__codelineno-0-194" name="__codelineno-0-194"></a>        <span class="p">),</span>
<a id="__codelineno-0-195" name="__codelineno-0-195"></a>    <span class="p">)</span>
<a id="__codelineno-0-196" name="__codelineno-0-196"></a>    <span class="c1"># Parse the csv of the per-image information</span>
<a id="__codelineno-0-197" name="__codelineno-0-197"></a>    <span class="c1"># Note that every image has first the useful information on one row and then unneeded</span>
<a id="__codelineno-0-198" name="__codelineno-0-198"></a>    <span class="c1"># keypoint information on the following row. Therefore, the keypoints are discarded.</span>
<a id="__codelineno-0-199" name="__codelineno-0-199"></a>    <span class="n">images_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span>
<a id="__codelineno-0-200" name="__codelineno-0-200"></a>        <span class="n">images_file</span><span class="p">,</span>
<a id="__codelineno-0-201" name="__codelineno-0-201"></a>        <span class="n">sep</span><span class="o">=</span><span class="s2">&quot; &quot;</span><span class="p">,</span>
<a id="__codelineno-0-202" name="__codelineno-0-202"></a>        <span class="n">skiprows</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span><span class="p">),</span>
<a id="__codelineno-0-203" name="__codelineno-0-203"></a>        <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
<a id="__codelineno-0-204" name="__codelineno-0-204"></a>        <span class="n">names</span><span class="o">=</span><span class="p">(</span>
<a id="__codelineno-0-205" name="__codelineno-0-205"></a>            <span class="s2">&quot;IMAGE_ID&quot;</span><span class="p">,</span>
<a id="__codelineno-0-206" name="__codelineno-0-206"></a>            <span class="s2">&quot;QW&quot;</span><span class="p">,</span>
<a id="__codelineno-0-207" name="__codelineno-0-207"></a>            <span class="s2">&quot;QX&quot;</span><span class="p">,</span>
<a id="__codelineno-0-208" name="__codelineno-0-208"></a>            <span class="s2">&quot;QY&quot;</span><span class="p">,</span>
<a id="__codelineno-0-209" name="__codelineno-0-209"></a>            <span class="s2">&quot;QZ&quot;</span><span class="p">,</span>
<a id="__codelineno-0-210" name="__codelineno-0-210"></a>            <span class="s2">&quot;TX&quot;</span><span class="p">,</span>
<a id="__codelineno-0-211" name="__codelineno-0-211"></a>            <span class="s2">&quot;TY&quot;</span><span class="p">,</span>
<a id="__codelineno-0-212" name="__codelineno-0-212"></a>            <span class="s2">&quot;TZ&quot;</span><span class="p">,</span>
<a id="__codelineno-0-213" name="__codelineno-0-213"></a>            <span class="s2">&quot;CAMERA_ID&quot;</span><span class="p">,</span>
<a id="__codelineno-0-214" name="__codelineno-0-214"></a>            <span class="s2">&quot;NAME&quot;</span><span class="p">,</span>
<a id="__codelineno-0-215" name="__codelineno-0-215"></a>        <span class="p">),</span>
<a id="__codelineno-0-216" name="__codelineno-0-216"></a>        <span class="n">usecols</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)),</span>
<a id="__codelineno-0-217" name="__codelineno-0-217"></a>    <span class="p">)</span>
<a id="__codelineno-0-218" name="__codelineno-0-218"></a>
<a id="__codelineno-0-219" name="__codelineno-0-219"></a>    <span class="c1"># TODO support more camera models</span>
<a id="__codelineno-0-220" name="__codelineno-0-220"></a>    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">cameras_data</span><span class="p">[</span><span class="s2">&quot;MODEL&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="s2">&quot;SIMPLE_RADIAL&quot;</span><span class="p">):</span>
<a id="__codelineno-0-221" name="__codelineno-0-221"></a>        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Not a supported camera model&quot;</span><span class="p">)</span>
<a id="__codelineno-0-222" name="__codelineno-0-222"></a>
<a id="__codelineno-0-223" name="__codelineno-0-223"></a>    <span class="c1"># Parse the camera parameters, creating a dict for each distinct camera model</span>
<a id="__codelineno-0-224" name="__codelineno-0-224"></a>    <span class="n">sensors_dict</span> <span class="o">=</span> <span class="p">{}</span>
<a id="__codelineno-0-225" name="__codelineno-0-225"></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">cameras_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<a id="__codelineno-0-226" name="__codelineno-0-226"></a>        <span class="c1"># Note that the convention in this tool is for cx, cy to be defined from the center</span>
<a id="__codelineno-0-227" name="__codelineno-0-227"></a>        <span class="c1"># not the corner so it must be shifted</span>
<a id="__codelineno-0-228" name="__codelineno-0-228"></a>        <span class="n">sensor_dict</span> <span class="o">=</span> <span class="p">{</span>
<a id="__codelineno-0-229" name="__codelineno-0-229"></a>            <span class="s2">&quot;image_width&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;WIDTH&quot;</span><span class="p">],</span>
<a id="__codelineno-0-230" name="__codelineno-0-230"></a>            <span class="s2">&quot;image_height&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;HEIGHT&quot;</span><span class="p">],</span>
<a id="__codelineno-0-231" name="__codelineno-0-231"></a>            <span class="s2">&quot;f&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PARAMS_F&quot;</span><span class="p">],</span>
<a id="__codelineno-0-232" name="__codelineno-0-232"></a>            <span class="s2">&quot;cx&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PARAMS_CX&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;WIDTH&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-233" name="__codelineno-0-233"></a>            <span class="s2">&quot;cy&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PARAMS_CY&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;HEIGHT&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span>
<a id="__codelineno-0-234" name="__codelineno-0-234"></a>            <span class="s2">&quot;distortion_params&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;r&quot;</span><span class="p">:</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;PARAMS_RADIAL&quot;</span><span class="p">]},</span>
<a id="__codelineno-0-235" name="__codelineno-0-235"></a>        <span class="p">}</span>
<a id="__codelineno-0-236" name="__codelineno-0-236"></a>        <span class="n">sensors_dict</span><span class="p">[</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;CAMERA_ID&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">sensor_dict</span>
<a id="__codelineno-0-237" name="__codelineno-0-237"></a>
<a id="__codelineno-0-238" name="__codelineno-0-238"></a>    <span class="c1"># Parse the per-image information</span>
<a id="__codelineno-0-239" name="__codelineno-0-239"></a>    <span class="n">cam_to_world_transforms</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-240" name="__codelineno-0-240"></a>    <span class="n">sensor_IDs</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-241" name="__codelineno-0-241"></a>    <span class="n">image_filenames</span> <span class="o">=</span> <span class="p">[]</span>
<a id="__codelineno-0-242" name="__codelineno-0-242"></a>
<a id="__codelineno-0-243" name="__codelineno-0-243"></a>    <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">images_data</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
<a id="__codelineno-0-244" name="__codelineno-0-244"></a>        <span class="c1"># Convert from the quaternion representation to the matrix one. Note that the W element</span>
<a id="__codelineno-0-245" name="__codelineno-0-245"></a>        <span class="c1"># is the first one in the COLMAP convention but the last one in scipy.</span>
<a id="__codelineno-0-246" name="__codelineno-0-246"></a>        <span class="n">rot_mat</span> <span class="o">=</span> <span class="n">Rotation</span><span class="o">.</span><span class="n">from_quat</span><span class="p">(</span>
<a id="__codelineno-0-247" name="__codelineno-0-247"></a>            <span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;QX&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;QY&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;QZ&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;QW&quot;</span><span class="p">])</span>
<a id="__codelineno-0-248" name="__codelineno-0-248"></a>        <span class="p">)</span><span class="o">.</span><span class="n">as_matrix</span><span class="p">()</span>
<a id="__codelineno-0-249" name="__codelineno-0-249"></a>        <span class="c1"># Get the camera translation</span>
<a id="__codelineno-0-250" name="__codelineno-0-250"></a>        <span class="n">translation_vec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;TX&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;TY&quot;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;TZ&quot;</span><span class="p">]])</span>
<a id="__codelineno-0-251" name="__codelineno-0-251"></a>
<a id="__codelineno-0-252" name="__codelineno-0-252"></a>        <span class="c1"># Create a 4x4 homogenous matrix representing the world_to_cam transform</span>
<a id="__codelineno-0-253" name="__codelineno-0-253"></a>        <span class="n">world_to_cam</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a id="__codelineno-0-254" name="__codelineno-0-254"></a>        <span class="c1"># Populate the sub-elements</span>
<a id="__codelineno-0-255" name="__codelineno-0-255"></a>        <span class="n">world_to_cam</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">rot_mat</span>
<a id="__codelineno-0-256" name="__codelineno-0-256"></a>        <span class="n">world_to_cam</span><span class="p">[:</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">translation_vec</span>
<a id="__codelineno-0-257" name="__codelineno-0-257"></a>        <span class="c1"># We need the cam to world transform. Since we&#39;re using a 4x4 representation, we can</span>
<a id="__codelineno-0-258" name="__codelineno-0-258"></a>        <span class="c1"># just invert the matrix</span>
<a id="__codelineno-0-259" name="__codelineno-0-259"></a>        <span class="n">cam_to_world</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">world_to_cam</span><span class="p">)</span>
<a id="__codelineno-0-260" name="__codelineno-0-260"></a>        <span class="n">cam_to_world_transforms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cam_to_world</span><span class="p">)</span>
<a id="__codelineno-0-261" name="__codelineno-0-261"></a>
<a id="__codelineno-0-262" name="__codelineno-0-262"></a>        <span class="c1"># Record which camera model is used and the image filename</span>
<a id="__codelineno-0-263" name="__codelineno-0-263"></a>        <span class="n">sensor_IDs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s2">&quot;CAMERA_ID&quot;</span><span class="p">])</span>
<a id="__codelineno-0-264" name="__codelineno-0-264"></a>        <span class="n">image_filenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="n">image_folder</span><span class="p">,</span> <span class="n">row</span><span class="p">[</span><span class="s2">&quot;NAME&quot;</span><span class="p">]))</span>
<a id="__codelineno-0-265" name="__codelineno-0-265"></a>
<a id="__codelineno-0-266" name="__codelineno-0-266"></a>    <span class="c1"># Instantiate the camera set</span>
<a id="__codelineno-0-267" name="__codelineno-0-267"></a>    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span>
<a id="__codelineno-0-268" name="__codelineno-0-268"></a>        <span class="n">cam_to_world_transforms</span><span class="o">=</span><span class="n">cam_to_world_transforms</span><span class="p">,</span>
<a id="__codelineno-0-269" name="__codelineno-0-269"></a>        <span class="n">intrinsic_params_per_sensor_type</span><span class="o">=</span><span class="n">sensors_dict</span><span class="p">,</span>
<a id="__codelineno-0-270" name="__codelineno-0-270"></a>        <span class="n">image_filenames</span><span class="o">=</span><span class="n">image_filenames</span><span class="p">,</span>
<a id="__codelineno-0-271" name="__codelineno-0-271"></a>        <span class="n">sensor_IDs</span><span class="o">=</span><span class="n">sensor_IDs</span><span class="p">,</span>
<a id="__codelineno-0-272" name="__codelineno-0-272"></a>        <span class="n">image_folder</span><span class="o">=</span><span class="n">image_folder</span><span class="p">,</span>
<a id="__codelineno-0-273" name="__codelineno-0-273"></a>        <span class="n">validate_images</span><span class="o">=</span><span class="n">validate_images</span><span class="p">,</span>
<a id="__codelineno-0-274" name="__codelineno-0-274"></a>    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="July 5, 2024 16:03:08 UTC">July 5, 2024</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date" title="July 3, 2024 19:46:43 UTC">July 3, 2024</span>
  </span>

    
    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="Contributors">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/russelldj" class="md-author" title="@russelldj">
          
          <img src="https://avatars.githubusercontent.com/u/29384527?v=4&size=72" alt="russelldj">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.tabs", "navigation.sections", "navigation.instant", "navigation.indexes", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy", "content.action.edit"], "search": "../../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.92b07e13.min.js"></script>
      
    
  </body>
</html>